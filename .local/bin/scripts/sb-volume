#!/bin/sh

# Check if PulseAudio/PipeWire is running
if ! pactl info >/dev/null 2>&1; then
    echo "| 󰟎 "
    exit
fi

# Get mute status
MUTED=$(pactl get-sink-mute @DEFAULT_SINK@ | awk '{print $2}')

# Get volume (last % value from pactl output)
VOL=$(pactl get-sink-volume @DEFAULT_SINK@ | grep -o '[0-9]\{1,3\}%' | tail -n1 | tr -d '%')

# Choose icon
if [ "$MUTED" = "yes" ]; then
    echo "| 󰖁 "
    exit
fi

if   [ "$VOL" -ge 90 ]; then icon="󰕾 "
elif [ "$VOL" -ge 70 ]; then icon="󰕾 "
elif [ "$VOL" -ge 40 ]; then icon="󰖀 "
elif [ "$VOL" -ge 1  ]; then icon="󰕿 "
else icon="󰝟 "
fi

# Print to dwmblocks
echo "| $icon - $VOL%"


# #!/bin/sh
#
# send_notify() {
#     if [ "$1" = "muted" ]; then
#         notify-send -u low -h string:x-dunst-stack-tag:volume "󰖁 Muted"
#     else
#         notify-send -u low -h string:x-dunst-stack-tag:volume "$2 $1%"
#     fi
# }
#
# # Check if PulseAudio/PipeWire is running
# if ! pactl info >/dev/null 2>&1; then
#     echo "| 󰟎 "
#     exit
# fi
#
# # Get mute status
# MUTED=$(pactl get-sink-mute @DEFAULT_SINK@ | awk '{print $2}')
#
# # Get volume (last % value from pactl output)
# VOL=$(pactl get-sink-volume @DEFAULT_SINK@ | grep -o '[0-9]\{1,3\}%' | tail -n1 | tr -d '%')
#
# # Choose icon
# if [ "$MUTED" = "yes" ]; then
#     echo "| 󰖁 "
#    # send_notify muted
#     exit
# fi
#
# if   [ "$VOL" -ge 90 ]; then icon="󰕾 "
# elif [ "$VOL" -ge 70 ]; then icon="󰕾 "
# elif [ "$VOL" -ge 40 ]; then icon="󰖀 "
# elif [ "$VOL" -ge 1  ]; then icon="󰕿 "
# else icon="󰝟 "
# fi
#
# # Print to dwmblocks
# echo "| $icon - $VOL%"

# Send dunst notification (replace the old one instead of stacking)
# send_notify "$VOL" "$icon"

# #!/bin/sh
#
# # Block button handling
# case $BLOCK_BUTTON in
# 	1) setsid -w -f "$TERMINAL" -e pulsemixer; pkill -RTMIN+10 "${STATUSBAR:-dwmblocks}" ;;
# 	2) pactl set-sink-mute @DEFAULT_SINK@ toggle; pkill -RTMIN+10 "${STATUSBAR:-dwmblocks}" ;;
# 	4) pactl set-sink-volume @DEFAULT_SINK@ +10%; pkill -RTMIN+10 "${STATUSBAR:-dwmblocks}" ;;
# 	5) pactl set-sink-volume @DEFAULT_SINK@ -10%; pkill -RTMIN+10 "${STATUSBAR:-dwmblocks}" ;;
# 	3) notify-send "📢 Volume module" "\- Shows volume 🔊, 🔇 if muted.
# - Middle click to mute.
# - Scroll to change volume." ;;
# 	6) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;;
# esac
#
# # Get mute status
# MUTED=$(pactl get-sink-mute @DEFAULT_SINK@ | grep -c yes)
#
# # Get volume
# VOL=$(pactl get-sink-volume @DEFAULT_SINK@ | awk '{print $5}' | head -n1 | tr -d '%')
#
# # Output icon
# if [ "$MUTED" -eq 1 ]; then
#     echo "| 󰖁 "
#     exit
# fi
#
# if [ "$VOL" -ge 70 ]; then
# 	icon="󰕾 "
# elif [ "$VOL" -ge 50 ]; then
# 	icon="󰖀 "
# elif [ "$VOL" -ge 10 ]; then
# 	icon="󰕿 "
# else
# 	icon="󰸈 "
# fi
#
# echo "| $icon"

